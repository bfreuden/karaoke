
sample_projects = {
    "amy-macdonald-dancing-in-the-dark": {
        "youtube_url": "https://www.youtube.com/watch?v=huMElOuIMmk",
        "genius_url": "https://genius.com/Amy-macdonald-dancing-in-the-dark-lyrics",
        "language": "en",
        "artist": "Amy MacDonald",
        "title": "Dancing in the dark"
    },
    "sexion-dassaut-ma-direction": {
        "youtube_url": "https://www.youtube.com/watch?v=Y7-vP7TnluY",
        "genius_url": "https://genius.com/Sexion-dassaut-ma-direction-lyrics",
        "language": "fr",
        "artist": "Sexion d'Assaut",
        "title": "Ma Direction"
    },
    "eminem-criminal": {
        "youtube_url": "https://www.youtube.com/watch?v=mR8_ldc9lag",
        "genius_url": "https://genius.com/Eminem-criminal-lyrics",
        "language": "en",
        "artist": "Eminem",
        "title": "Criminal"
    },
    "afi-17-crimes": {
        "youtube_url": "https://www.youtube.com/watch?v=Y9Vh8XGgqjE",
        "genius_url": "https://genius.com/Afi-17-crimes-lyrics",
        "language": "en",
        "artist": "AFI",
        "title": "17 Crimes"
    },
    "afi-medicate": {
        "youtube_url": "https://www.youtube.com/watch?v=wCwEBz3ego8",
        "genius_url": "https://genius.com/Afi-medicate-lyrics",
        "language": "en",
        "artist": "AFI",
        "title": "Medicate"
    },
    "poets-of-the-fall-standstill": {
        "youtube_url": "https://www.youtube.com/watch?v=FsKxXnAoSDo",
        "genius_url": "https://genius.com/Poets-of-the-fall-standstill-lyrics",
        "language": "en",
        "artist": "Poets of the Fall",
        "title": "Standstill"
    },
    "faouzia-thick-and-thin": {
        "youtube_url": "https://www.youtube.com/watch?v=2Xn_PKpCSL0",
        "genius_url": "https://genius.com/Faouzia-thick-and-thin-lyrics",
        "language": "en",
        "artist": "Faouzia",
        "title": "Thick and Thin"
    },
    "sting-shape-of-my-heart": {
        "youtube_url": "https://www.youtube.com/watch?v=NlwIDxCjL-8",
        "genius_url": "https://genius.com/Sting-shape-of-my-heart-lyrics",
        "language": "en",
        "artist": "Sting",
        "title": "Shape of my heart"
    },
    "naheulband-nanana-de-lelfe": {
        "youtube_url": "https://www.youtube.com/watch?v=5bqinpLmoxk",
        "genius_url": "https://genius.com/Naheulband-nanana-de-lelfe-lyrics",
        "language": "fr",
        "artist": "Naheulband",
        "title": "Nanana de l'Elfe"
    },
    "frieren-hareru": {
        "youtube_url": "https://www.youtube.com/watch?v=iqsnJJK8GA4",
        "genius_url": "",
        "language": "jp",
        "artist": "Frieren",
        "title": "Hareru"
    },
    "metallica-unforgiven-3": {
        "youtube_url": "https://www.youtube.com/watch?v=OMJREChN8nY",
        "genius_url": "https://genius.com/Metallica-the-unforgiven-iii-lyrics",
        "language": "en",
        "artist": "Metallica",
        "title": "Unforgiven 3"
    },
    "slash-far-and-away": {
        "youtube_url": "https://www.youtube.com/watch?v=S3hoIetxhZw",
        "genius_url": "https://genius.com/Slash-far-and-away-lyrics",
        "language": "en",
        "artist": "Slash",
        "title": "Far and Away"
    },
    "slash-ghost": {
        "youtube_url": "https://www.youtube.com/watch?v=ZaAZjlHa7Uc",
        "genius_url": "https://genius.com/Slash-ghost-lyrics",
        "language": "en",
        "artist": "Slash",
        "title": "Ghost"
    },
    "slash-back-from-cali": {
        "youtube_url": "https://www.youtube.com/watch?v=eCGSNO9dqUk",
        "genius_url": "https://genius.com/Slash-back-from-cali-lyrics",
        "language": "en",
        "artist": "Slash",
        "title": "Back from Cali"
    },
    "metallica-turn-the-page": {
        "youtube_url": "https://www.youtube.com/watch?v=5EAIJv_OM4w",
        "genius_url": "https://genius.com/Metallica-turn-the-page-lyrics",
        "language": "en",
        "artist": "Metallica",
        "title": "Turn the Page"
    },
    "manau-la-tribu-de-dana": {
        "youtube_url": "https://www.youtube.com/watch?v=80hMEKlLVgQ",
        "genius_url": "https://genius.com/Manau-tribu-de-dana-lyrics",
        "language": "fr",
        "artist": "Manau",
        "title": "La Tribu de Dana"
    },
    "jeff-buckley-hallelujah": {
        "youtube_url": "https://www.youtube.com/watch?v=WIF4_Sm-rgQ",
        "genius_url": "https://genius.com/Manau-tribu-de-dana-lyrics",
        "language": "en",
        "artist": "Jeff Buckley",
        "title": "Hallelujah"
    },
    "kula-shaker-hosannah": {
        "youtube_url": "https://www.youtube.com/watch?v=odZPnQ-t6Yk",
        "genius_url": "https://genius.com/Kula-shaker-great-hosannah-lyrics",
        "language": "en",
        "artist": "Kula Shaker",
        "title": "Hosannah"
    },
    "good-charlotte-riot-girl": {
        "youtube_url": "https://www.youtube.com/watch?v=cDtOyMr_kgk",
        "genius_url": "https://genius.com/Good-charlotte-riot-girl-lyrics",
        "language": "en",
        "artist": "Good Charlotte",
        "title": "Riot Girl"
    },
    "daughtry-its-not-over": {
        "youtube_url": "https://www.youtube.com/watch?v=UQ92eyxnxmQ",
        "genius_url": "https://genius.com/Daughtry-its-not-over-lyrics",
        "language": "en",
        "artist": "Daughtry",
        "title": "It's not over"
    },
    "daughtry-the-dam": {
        "youtube_url": "https://www.youtube.com/watch?v=3xqlEdPyo44",
        "genius_url": "https://genius.com/Daughtry-the-dam-lyrics",
        "language": "en",
        "artist": "Daughtry",
        "title": "The Dam"
    },
    "poets-of-the-fall-my-dark-disquiet": {
        "youtube_url": "https://www.youtube.com/watch?v=aMT5Tuw0yZk",
        "genius_url": "https://genius.com/Poets-of-the-fall-my-dark-disquiet-lyrics",
        "language": "en",
        "artist": "Poets of the Fall",
        "title": "My Dark Disquiet"
    }
}

from get_or_create_karaoke_project_data import get_or_create_project_from_data, get_project_dir_from_data
#
# def get_sample_project(project_name):
#     from directories import data_dir
#     return get_project(sample_projects[project_name]['youtube_url'])
#
def get_or_create_sample_project(project_name, force=False):
    project_data = sample_projects[project_name]
    return get_or_create_project_from_data(project_data, get_only=True, force=force)

def get_sample_project_dir(project_name, force=False):
    project_data = get_or_create_sample_project(project_name, force=force)
    return get_project_dir_from_data(project_data, force=force)

def get_sample_project_items(project_name, *args):
    project_data = get_or_create_project_from_data(sample_projects[project_name], get_only=True)
    return tuple(get_project_dir_from_data(project_data) if arg == 'project_dir' else project_data[arg] for arg in args)


def migrate_new_layout():
    import json
    from src.get_or_create_karaoke_project_data import slugify_karaoke
    from directories import output_dir, data_dir
    import shutil
    import os
    projects_pickle = f'{output_dir}/projects.pickle'
    import pickle
    with open(projects_pickle, 'rb') as file:
        projects = pickle.load(file)
    with open(f'{data_dir}/karaokes.json', mode='r') as fp:
        karaokes = json.load(fp)

    new_sample_projects = {}
    for key, value in projects.items():
        print(key, value)
        slug = None
        the_value2 = None
        for key2, value2 in sample_projects.items():
            if value2["youtube_url"] == value["youtube_url"]:
                slug = value["slug"]
                the_value2 = value2
                break
        if slug is None:
            raise Exception()
        artist = the_value2['artist']
        title_ = the_value2['title']
        new_slug = slugify_karaoke(artist, title_)
        if not os.path.exists(f"{data_dir}/{new_slug}"):
            print(f"Moving {output_dir}/{slug} into {data_dir}/{new_slug}")
            shutil.move(f"{output_dir}/{slug}", f"{data_dir}/{new_slug}")
            karaokes[new_slug] = {"artist": artist, "title": title_}
            with open(f"{data_dir}/{new_slug}/_data.json", mode='w') as fp:
                json.dump(
                    {
                        "artist": artist,
                        "title": title_,
                        "youtube_url": the_value2["youtube_url"],
                        "genius_url": the_value2["genius_url"],
                        'language': the_value2['language'],
                    }, fp, indent=4)
            new_sample_projects[new_slug] = {
                'youtube_url': the_value2["youtube_url"],
                'genius_url': the_value2["genius_url"],
                'language': the_value2['language'],
                'artist': artist,
                'title': title_,
            }
            print("Done")
    with open(f'{data_dir}/karaokes.json', mode='w') as fp:
        json.dump(karaokes, fp, indent=4)
    with open(f'{os.path.dirname(__file__)}/new_sample_projects.json', mode='w') as fp:
        json.dump(new_sample_projects, fp, indent=4)

def bootstrap_data_dir():
    import json
    from directories import data_dir
    import os
    karaokes = {}
    if os.path.exists(f'{data_dir}/karaokes.json'):
        with open(f'{data_dir}/karaokes.json', mode='r') as fp:
            karaokes = json.load(fp)

    for slug, project_data in sample_projects.items():
        artist = project_data['artist']
        title_ = project_data['title']
        if not os.path.exists(f'{data_dir}/{slug}'):
            os.makedirs(f'{data_dir}/{slug}')
        karaokes[slug] = {"artist": artist, "title": title_}
        if not os.path.exists(f'{data_dir}/{slug}/_data.json'):
            with open(f"{data_dir}/{slug}/_data.json", mode='w') as fp:
                json.dump(
                    {
                        "artist": artist,
                        "title": title_,
                        "youtube_url": project_data["youtube_url"],
                        "genius_url": project_data["genius_url"],
                    }, fp, indent=4)
    with open(f'{data_dir}/karaokes.json', mode='w') as fp:
        json.dump(karaokes, fp, indent=4)

if __name__ == '__main__':
    # migrate_new_layout()
    bootstrap_data_dir()
